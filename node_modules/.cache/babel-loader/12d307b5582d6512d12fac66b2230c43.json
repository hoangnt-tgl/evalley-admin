{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport statusIcon from \"../../components/featherIcons/status-icon.vue\";\nconst {\n  BASE_URL\n} = require('../../config');\nexport default {\n  components: {\n    statusIcon\n  },\n  data() {\n    return {\n      items: [],\n      tablefields: [{\n        key: \"delete\"\n      }, {\n        key: \"title\",\n        label: \"Title\",\n        sortable: true\n      }, {\n        key: \"code\",\n        label: \"Code\",\n        sortable: true\n      }, {\n        key: \"discount\",\n        label: \"Discount\",\n        sortable: true\n      }, {\n        key: \"type\",\n        label: \"Type\",\n        sorttable: true\n      }, {\n        key: \"status\",\n        label: \"Status\",\n        sortable: true\n      }],\n      filter: null,\n      totalRows: 1,\n      currentPage: 1,\n      perPage: 10,\n      pageOptions: [5, 10, 15],\n      selectMode: \"multi\",\n      selected: []\n    };\n  },\n  created() {\n    this.$http.post(`${BASE_URL}/voucher/getall`, {\n      token: \"\"\n    }).then(response => {\n      this.items = response.data;\n      console.log(this.items);\n    }).catch(function (error) {\n      console.log('error', error);\n    });\n  },\n  mounted() {\n    // Set the initial number of items\n    this.totalRows = this.items.length;\n  },\n  computed: {\n    sortOptions() {\n      // Create an options list from our fields\n      return this.tablefields.filter(f => f.sortable).map(f => {\n        return {\n          text: f.label,\n          value: f.key\n        };\n      });\n    },\n    selectedRows() {\n      return this.items.filter(item => item.delete);\n    }\n  },\n  methods: {\n    deleteSelected(item) {\n      let objIndex = this.selected.findIndex(obj => obj == item._id);\n      if (objIndex > -1) {\n        this.selected.splice(objIndex, 1);\n      } else {\n        this.selected.push(item._id);\n      }\n    },\n    onFiltered(filteredItems) {\n      // Trigger pagination to update the number of buttons/pages due to filtering\n      this.totalRows = filteredItems.length;\n      this.currentPage = 1;\n    },\n    rowSelected(item) {\n      this.selected = item._id;\n    },\n    deleteRow() {\n      for (var i = this.items.length - 1; i >= 0; i--) {\n        for (var j = 0; j < this.selected.length; j++) {\n          if (this.items[i] && this.items[i]._id === this.selected[j]) {\n            this.items.splice(i, 1);\n          }\n        }\n      }\n      this.$http.post(`${BASE_URL}/voucher/delete`, {\n        token: \"\",\n        selected: this.selected\n      }).then(response => {\n        if (response.data.success) {\n          this.$toasted.show(response.data.message, {\n            theme: \"bubble\",\n            position: \"top-right\",\n            type: \"success\",\n            duration: 2000\n          });\n        } else {\n          this.$toasted.show(response.data.message, {\n            theme: \"bubble\",\n            position: \"top-right\",\n            type: \"error\",\n            duration: 2000\n          });\n        }\n      }).catch(function (error) {\n        console.log('error', error);\n      });\n    },\n    deleteBatchRow() {\n      for (var i = 0; i < this.selected.length; i++) {\n        if (this.items[i]._id == this.selected[i]) {\n          this.items.splice(this.items[i], 1);\n        }\n      }\n    },\n    showMsgBoxTwo() {\n      this.$bvModal.msgBoxConfirm('Are you sure!', {\n        title: 'Confirmation',\n        size: 'md',\n        buttonSize: 'sm',\n        okVariant: 'primary',\n        okTitle: 'YES',\n        cancelTitle: 'CANCLE',\n        footerClass: 'p-2',\n        hideHeaderClose: false\n        // centered: true\n      }).then(value => {\n        if (value) {\n          this.deleteRow();\n          this.selected = [];\n        }\n      }).catch(err => {\n        // An error occurred\n      });\n    }\n  }\n};","map":{"version":3,"mappings":";AAuGA;AACA;EAAAA;AAAA;AACA;EACAC;IAAAC;EAAA;EACAC;IACA;MACAC;MACAC,cACA;QAAAC;MAAA,GACA;QAAAA;QAAAC;QAAAC;MAAA,GACA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAAF;QAAAC;QAAAE;MAAA,GACA;QAAAH;QAAAC;QAAAC;MAAA,EACA;MACAE;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;IACA;EACA;EACAC;IACA;MACAC;IACA,GACAC;MACA;MACAC;IACA,GACAC;MACAD;IACA;EACA;EAEAE;IACA;IACA;EACA;EACAC;IACAC;MACA;MACA,wBACAd,wBACAe;QACA;UAAAC;UAAAC;QAAA;MACA;IACA;IACAC;MACA;IACA;EACA;EACAC;IACAC;MACA;MACA;QACA;MACA;QACA;MACA;IACA;IACAC;MACA;MACA;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;QACA;UACA;YACA;UACA;QACA;MACA;MACA;QACAf;QACAF;MACA,GACAG;QACA;UACA;YACAe;YACAC;YACAC;YACAC;UACA;QACA;UACA;YACAH;YACAC;YACAC;YACAC;UACA;QACA;MACA,GACAhB;QACAD;MACA;IACA;IACAkB;MACA;QACA;UACA;QACA;MACA;IACA;IACAC;MACA;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACA;MACA,GACA5B;QACA;UACA;UACA;QACA;MACA,GACAE;QACA;MACA;IACA;EACA;AACA","names":["BASE_URL","components","statusIcon","data","items","tablefields","key","label","sortable","sorttable","filter","totalRows","currentPage","perPage","pageOptions","selectMode","selected","created","token","then","console","catch","mounted","computed","sortOptions","map","text","value","selectedRows","methods","deleteSelected","onFiltered","rowSelected","deleteRow","theme","position","type","duration","deleteBatchRow","showMsgBoxTwo","title","size","buttonSize","okVariant","okTitle","cancelTitle","footerClass","hideHeaderClose"],"sourceRoot":"src/views/coupans","sources":["CoupanList.vue"],"sourcesContent":["<template>\n  <div>\n    <div class=\"container-fluid\">\n      <div class=\"page-header\">\n        <Breadcrumbs main=\"Coupons\" title=\"Coupon List\" />\n      </div>\n    </div>\n    <!-- Container-fluid starts-->\n    <div class=\"container-fluid\">\n      <div class=\"row\">\n        <div class=\"col-md-12\">\n          <div class=\"card\">\n            <div class=\"card-header\">\n              <h5>Discount coupon detail</h5>\n            </div>\n            <div class=\"card-body\">\n\t\t\t\t\t\t\t\n              <b-row>\n                <b-col xl=\"3\" lg=\"4\" md=\"6\">\n                  <b-form-group\n                    label-cols=\"3\"\n                    label=\"show\"\n                    class=\"datatable-select\"\n                  >\n                    <b-form-select\n                      v-model=\"perPage\"\n                      :options=\"pageOptions\"\n                    ></b-form-select>\n                  </b-form-group>\n                </b-col>\n                <b-col class=\"offset-xl-6 offset-lg-2 search-rs\" xl=\"3\" lg=\"5\" md=\"6\">\n                  <b-form-group\n                    label-cols=\"3\"\n                    label=\"Search\"\n                    class=\"datatable-select\"\n                  >\n                    <b-form-input\n                      type=\"text\"\n                      v-model=\"filter\"\n                      placeholder=\"Search\"\n                    ></b-form-input>\n                  </b-form-group>\n                </b-col>\n              </b-row>\n              <div class=\"table-responsive datatable-vue\">\n                <div>\n                  <b-modal\n                    id=\"modal-1\"\n                    title=\"Confirmation\"\n                  >\n                    <p class=\"my-4\">Are you sure!</p>\n                  </b-modal>\n                </div>\n                <b-table\n                  class=\"text-center\"\n                  show-empty\n                  striped\n                  hover\n                  head-variant=\"light\"\n                  bordered\n                  stacked=\"md\"\n                  :items=\"items\"\n                  :fields=\"tablefields\"\n                  :filter=\"filter\"\n                  :current-page=\"currentPage\"\n                  :per-page=\"perPage\"\n                  @filtered=\"onFiltered\"\n                  @row-selected=\"rowSelected\"\n                >\n                  <template v-slot:head(delete)>\n                    <b-button\n                      variant=\"danger\"\n                      :disabled=\"selectedRows.length === 0\"\n                      @click=\"showMsgBoxTwo\"\n                      >Delete</b-button\n                    >\n                  </template>\n                  <template #cell(status)=\"field\">\n                    <statusIcon :field=\"field\"></statusIcon>\n                  </template>\n                  <b-table-column v-slot:cell(delete)>\n                    <a href=\"#\">edit</a>\n                    <a href=\"#\"> remove</a>\n                  </b-table-column>\n\n                  <template v-slot:cell(delete)=\"{ item, field: { key } }\">\n                    <b-checkbox\n                      v-model=\"item[key]\"\n                      @change=\"deleteSelected(item)\"\n                    ></b-checkbox>\n                  </template>\n                </b-table>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <!-- Container-fluid Ends-->\n  </div>\n</template>\n\n<script>\nimport statusIcon from \"../../components/featherIcons/status-icon.vue\";\nconst {BASE_URL} =  require('../../config')\nexport default {\n  components: { statusIcon },\n  data() {\n    return {\n      items: [],\n      tablefields: [\n        { key: \"delete\" },\n        { key: \"title\", label: \"Title\", sortable: true },\n        { key: \"code\", label: \"Code\", sortable: true },\n        { key: \"discount\", label: \"Discount\", sortable: true },\n        { key: \"type\", label: \"Type\", sorttable: true },\n        { key: \"status\", label: \"Status\", sortable: true }\n      ],\n      filter: null,\n      totalRows: 1,\n      currentPage: 1,\n      perPage: 10,\n      pageOptions: [5, 10, 15],\n      selectMode: \"multi\",\n      selected: []\n    };\n  },\n  created() {\n    this.$http.post(`${BASE_URL}/voucher/getall`, {\n      token: \"\"\n    })\n    .then(response => {\n\t\t\tthis.items = response.data   \n\t\t\tconsole.log(this.items)        \n    })\n    .catch(function (error) {\n\t\t\tconsole.log('error', error);\n    });\n  },\n\n  mounted() {\n    // Set the initial number of items\n    this.totalRows = this.items.length;\n  },\n  computed: {\n    sortOptions() {\n      // Create an options list from our fields\n      return this.tablefields\n        .filter(f => f.sortable)\n        .map(f => {\n          return { text: f.label, value: f.key };\n        });\n    },\n    selectedRows() {\n      return this.items.filter(item => item.delete);\n    }\n  },\n  methods: {\n    deleteSelected(item) {\n      let objIndex = this.selected.findIndex((obj => obj == item._id));\n      if (objIndex > -1) {\n        this.selected.splice(objIndex, 1);\n      } else {\n        this.selected.push(item._id)\n      }\n    },\n    onFiltered(filteredItems) {\n      // Trigger pagination to update the number of buttons/pages due to filtering\n      this.totalRows = filteredItems.length;\n      this.currentPage = 1;\n    },\n    rowSelected(item) {\n      this.selected = item._id;\n    },\n    deleteRow() {\n      for( var i=this.items.length - 1; i>=0; i--){\n        for( var j=0; j<this.selected.length; j++){\n          if(this.items[i] && (this.items[i]._id === this.selected[j])){\n            this.items.splice(i, 1);\n          }\n        }\n      }\n\t\t\tthis.$http.post(`${BASE_URL}/voucher/delete`, {\n\t\t\t\ttoken: \"\",\n\t\t\t\tselected: this.selected\n\t\t\t})\n\t\t\t.then(response => {\n\t\t\t\tif(response.data.success){\n\t\t\t\t\tthis.$toasted.show(response.data.message, {\n\t\t\t\t\t\ttheme: \"bubble\",\n\t\t\t\t\t\tposition: \"top-right\",\n\t\t\t\t\t\ttype: \"success\",\n\t\t\t\t\t\tduration: 2000\n\t\t\t\t\t});             \n\t\t\t\t} else {\n\t\t\t\t\tthis.$toasted.show(response.data.message, {\n\t\t\t\t\t\ttheme: \"bubble\",\n\t\t\t\t\t\tposition: \"top-right\",\n\t\t\t\t\t\ttype: \"error\",\n\t\t\t\t\t\tduration: 2000\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(function (error) {\n\t\t\t\tconsole.log('error', error);\n\t\t\t});\n    },\n    deleteBatchRow() {\n      for (var i = 0; i < this.selected.length; i++) {\n        if (this.items[i]._id == this.selected[i]) {\n          this.items.splice(this.items[i], 1);\n        }\n      }\n    },\n    showMsgBoxTwo() {\n        this.$bvModal.msgBoxConfirm('Are you sure!', {\n          title: 'Confirmation',\n          size: 'md',\n          buttonSize: 'sm',\n          okVariant: 'primary',\n          okTitle: 'YES',\n          cancelTitle: 'CANCLE',\n          footerClass: 'p-2',\n          hideHeaderClose: false,\n          // centered: true\n        })\n          .then(value => {\n\t\t\t\t\t\tif (value){\n\t\t\t\t\t\t\tthis.deleteRow();\n\t\t\t\t\t\t\tthis.selected = [];\n\t\t\t\t\t\t}\n          })\n          .catch(err => {\n            // An error occurred\n          })\n      }\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\ntable.text-center * {\n  text-align: center;\n}\n</style>"]},"metadata":{},"sourceType":"module"}